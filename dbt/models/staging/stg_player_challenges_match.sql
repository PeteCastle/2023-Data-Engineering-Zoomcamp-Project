{{ config(materialized='view')}}
WITH temp_table AS(
    SELECT
        row_number() OVER(PARTITION BY summonerName,matchId ORDER BY summonerName) AS rownum, --This is to ensure that MATCHES will only receive the latest record
        summonerName,
        matchId,
        12AssistStreakCount,
        abilityUses,
        acesBefore15Minutes,
        alliedJungleMonsterKills,
        baronTakedowns,
        blastConeOppositeOpponentCount,
        bountyGold,
        buffsStolen,
        completeSupportQuestInTime,
        controlWardsPlaced,
        damagePerMinute,
        damageTakenOnTeamPercentage,
        dancedWithRiftHerald,
        deathsByEnemyChamps,
        dodgeSkillShotsSmallWindow,
        doubleAces,
        dragonTakedowns,
        earlyLaningPhaseGoldExpAdvantage,
        effectiveHealAndShielding,
        elderDragonKillsWithOpposingSoul,
        elderDragonMultikills,
        enemyChampionImmobilizations,
        enemyJungleMonsterKills,
        epicMonsterKillsNearEnemyJungler,
        epicMonsterKillsWithin30SecondsOfSpawn,
        epicMonsterSteals,
        epicMonsterStolenWithoutSmite,
        firstTurretKilledTime,
        flawlessAces,
        fullTeamTakedown,
        gameLength,
        getTakedownsInAllLanesEarlyJungleAsLaner,
        goldPerMinute,
        hadOpenNexus,
        highestCrowdControlScore,
        immobilizeAndKillWithAlly,
        initialBuffCount,
        initialCrabCount,
        jungleCsBefore10Minutes,
        junglerTakedownsNearDamagedEpicMonster,
        kTurretsDestroyedBeforePlatesFall,
        kda,
        killAfterHiddenWithAlly,
        killParticipation,
        killedChampTookFullTeamDamageSurvived,
        killingSprees,
        killsNearEnemyTurret,
        killsOnOtherLanesEarlyJungleAsLaner,
        killsOnRecentlyHealedByAramPack,
        killsUnderOwnTurret,
        killsWithHelpFromEpicMonster,
        knockEnemyIntoTeamAndKill,
        landSkillShotsEarlyGame,
        laneMinionsFirst10Minutes,
        laningPhaseGoldExpAdvantage,
        legendaryCount,
        lostAnInhibitor,
        maxCsAdvantageOnLaneOpponent,
        maxKillDeficit,
        maxLevelLeadLaneOpponent,
        moreEnemyJungleThanOpponent,
        multiKillOneSpell,
        multiTurretRiftHeraldCount,
        multikills,
        multikillsAfterAggressiveFlash,
        mythicItemUsed,
        outerTurretExecutesBefore10Minutes,
        outnumberedKills,
        outnumberedNexusKill,
        perfectDragonSoulsTaken,
        perfectGame,
        pickKillWithAlly,
        poroExplosions,
        quickCleanse,
        quickFirstTurret,
        quickSoloKills,
        riftHeraldTakedowns,
        saveAllyFromDeath,
        scuttleCrabKills,
        shortestTimeToAceFromFirstTakedown,
        skillshotsDodged,
        skillshotsHit,
        snowballsHit,
        soloBaronKills,
        soloKills,
        stealthWardsPlaced,
        survivedSingleDigitHpCount,
        survivedThreeImmobilizesInFight,
        takedownOnFirstTurret,
        takedowns,
        takedownsAfterGainingLevelAdvantage,
        takedownsBeforeJungleMinionSpawn,
        takedownsFirstXMinutes,
        takedownsInAlcove,
        takedownsInEnemyFountain,
        teamBaronKills,
        teamDamagePercentage,
        teamElderDragonKills,
        teamRiftHeraldKills,
        threeWardsOneSweeperCount,
        tookLargeDamageSurvived,
        turretPlatesTaken,
        turretTakedowns,
        turretsTakenWithRiftHerald,
        twentyMinionsIn3SecondsCount,
        unseenRecalls,
        visionScoreAdvantageLaneOpponent,
        visionScorePerMinute,
        wardTakedowns,
        wardTakedownsBefore20M,
        wardsGuarded,
        highestChampionDamage
    FROM player_challenges_match
)
SELECT *
FROM temp_table
where rownum = 1