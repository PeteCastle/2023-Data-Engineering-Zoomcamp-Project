{{ config(materialized='view')}}
    WITH temp_table AS (
    SELECT
        row_number() OVER(PARTITION BY matchId ORDER BY 1) AS rownum, --This is to ensure that MATCHES will only receive the latest record
        matchId,
        bans_turn_1,
        bans_turn_10,
        bans_turn_2,
        bans_turn_3,
        bans_turn_4,
        bans_turn_5,
        bans_turn_6,
        bans_turn_7,
        bans_turn_8,
        bans_turn_9,
        blue_baron_isFirstKill,
        blue_baron_kills,
        blue_champion_isFirstKill,
        blue_champion_kills,
        blue_dragon_isFirstKill,
        blue_dragon_kills,
        blue_inhibitor_isFirstKill,
        blue_inhibitor_kills,
        blue_riftHerald_isFirstKill,
        blue_riftHerald_kills,
        blue_tower_isFirstKill,
        blue_tower_kills,
        blue_win,
        red_baron_isFirstKill,
        red_baron_kills,
        red_champion_isFirstKill,
        red_champion_kills,
        red_dragon_isFirstKill,
        red_dragon_kills,
        red_inhibitor_isFirstKill,
        red_inhibitor_kills,
        red_riftHerald_isFirstKill,
        red_riftHerald_kills,
        red_tower_isFirstKill,
        red_tower_kills,
        red_win
    FROM teams_match
)
SELECT 
    matchId,
    bans_turn_1,
    bans_turn_10,
    bans_turn_2,
    bans_turn_3,
    bans_turn_4,
    bans_turn_5,
    bans_turn_6,
    bans_turn_7,
    bans_turn_8,
    bans_turn_9,
    blue_baron_isFirstKill,
    blue_baron_kills,
    blue_champion_isFirstKill,
    blue_champion_kills,
    blue_dragon_isFirstKill,
    blue_dragon_kills,
    blue_inhibitor_isFirstKill,
    blue_inhibitor_kills,
    blue_riftHerald_isFirstKill,
    blue_riftHerald_kills,
    blue_tower_isFirstKill,
    blue_tower_kills,
    blue_win,
    red_baron_isFirstKill,
    red_baron_kills,
    red_champion_isFirstKill,
    red_champion_kills,
    red_dragon_isFirstKill,
    red_dragon_kills,
    red_inhibitor_isFirstKill,
    red_inhibitor_kills,
    red_riftHerald_isFirstKill,
    red_riftHerald_kills,
    red_tower_isFirstKill,
    red_tower_kills,
    red_win
FROM temp_table
WHERE rownum = 1